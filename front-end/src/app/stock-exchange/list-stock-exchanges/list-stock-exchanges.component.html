<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3>Stock Exchanges List</h3>

    <div>
      <button class="btn btn-outline-secondary me-2" (click)="goToDashboard()">
        <i class="bi bi-house-door"></i> Dashboard
      </button>

      <button class="btn btn-success" (click)="goToCreate()">
        <i class="bi bi-plus-lg"></i> Create Stock Exchange
      </button>

      <button class="btn btn-outline-secondary me-2" (click)="goToLogout()">
        <i class="bi bi-house-door"></i> Logout
      </button>
    </div>
  </div>

  <div *ngIf="isLoading" class="text-center mb-3">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <div *ngIf="errorMessage" class="alert alert-danger text-center">
    {{ errorMessage }}
  </div>

  <div class="table-wrapper">
    <table *ngIf="stockExchanges.length > 0" class="table table-striped table-bordered">
      <thead>
        <tr>
          <th (click)="changeSort('id')">
            ID
            <span *ngIf="sortField === 'id'">
              <i *ngIf="sortOrder === 'asc'" class="bi bi-caret-up-fill"></i>
              <i *ngIf="sortOrder === 'desc'" class="bi bi-caret-down-fill"></i>
            </span>
          </th>
          <th (click)="changeSort('name')">
            Name
            <span *ngIf="sortField === 'name'">
              <i *ngIf="sortOrder === 'asc'" class="bi bi-caret-up-fill"></i>
              <i *ngIf="sortOrder === 'desc'" class="bi bi-caret-down-fill"></i>
            </span>
          </th>
          <th (click)="changeSort('description')">
            Description
            <span *ngIf="sortField === 'description'">
              <i *ngIf="sortOrder === 'asc'" class="bi bi-caret-up-fill"></i>
              <i *ngIf="sortOrder === 'desc'" class="bi bi-caret-down-fill"></i>
            </span>
          </th>
          <th>Live In Market</th>
          <th>Stocks</th>
          <th>Actions</th> <!-- New column for buttons -->
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let exchange of stockExchanges">
          <td>
            <a [routerLink]="['/stock-exchange/view', exchange.id]">
              {{ exchange.id }}
            </a>
          </td>
          <td>{{ exchange.name }}</td>
          <td>{{ exchange.description }}</td>
          <td>{{ exchange.liveInMarket ? 'Yes' : 'No' }}</td>
          <td>
            <ul>
              <li *ngFor="let stock of exchange.stocks">
                {{ stock.name }} - {{ stock.currentPrice }}
              </li>
            </ul>
          </td>
          <td>
            <button class="btn btn-primary btn-sm me-2" (click)="goToUpdate(exchange)">
              <i class="bi bi-pencil-square"></i> Update
            </button>
            <button class="btn btn-danger btn-sm" (click)="deleteExchange(exchange.id)">
              <i class="bi bi-trash"></i> Delete
            </button>

            <button class="btn btn-success btn-sm me-2" (click)="goToAddStock(exchange.id)">
              <i class="bi bi-plus-circle"></i> Add Stock
            </button>

            <button class="btn btn-warning btn-sm" (click)="goToRemoveStock(exchange.id)">
              <i class="bi bi-dash-circle"></i> Remove Stock
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  
  <div class="d-flex justify-content-between mt-3">
    <button class="btn btn-outline-secondary" (click)="goToPage(currentPage - 1)">Previous</button>
    <span>Page {{ currentPage }} / {{ totalPages }}</span>
    <button class="btn btn-outline-secondary" (click)="goToPage(currentPage + 1)">Next</button>
  </div>

</div>